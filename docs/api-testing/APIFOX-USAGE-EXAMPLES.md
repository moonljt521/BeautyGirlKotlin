# Apifox MCP 使用示例

## 🎯 实际使用场景

配置完 Apifox MCP Server 后，你可以直接在 Kiro 聊天窗口中进行以下操作。

## 📋 基础操作

### 1. 列出所有项目

**你说：**
```
列出我的 Apifox 项目
```

**AI 回复：**
```
找到以下项目：
1. BeautyGirl API (ID: xxx)
2. 测试项目 (ID: yyy)
3. ...
```

### 2. 列出项目的所有接口

**你说：**
```
列出 BeautyGirl API 项目的所有接口
```

**AI 回复：**
```
找到以下接口：
1. GET /api/data/福利/{number}/{page} - 获取 Gank 福利图片
2. GET /?cid={cid}&page={page} - 获取豆瓣图片
3. GET /bizhitupian/meinvbizhi/ - 获取优美图库图片
```

### 3. 查看接口详情

**你说：**
```
查看 "获取 Gank 福利图片" 接口的详细信息
```

**AI 回复：**
```
接口详情：
- 名称: 获取 Gank 福利图片
- 方法: GET
- 路径: /api/data/福利/{number}/{page}
- 参数:
  - number: 每页数量 (路径参数)
  - page: 页码 (路径参数)
- 响应示例: {...}
```

### 4. 调用接口测试

**你说：**
```
调用 Gank API，获取 10 条数据，第 1 页
```

**AI 回复：**
```
正在调用接口...

请求:
GET http://gank.io/api/data/福利/10/1

响应 (200 OK):
{
  "error": false,
  "results": [
    {
      "_id": "xxx",
      "url": "http://...",
      "desc": "美女图片"
    },
    ...
  ]
}

耗时: 234ms
```

## 🔍 高级场景

### 场景 1: 批量测试不同参数

**你说：**
```
帮我测试 Gank API，分别使用 number=5, 10, 20，看看返回的数据量是否正确
```

**AI 回复：**
```
正在批量测试...

测试 1: number=5, page=1
✅ 成功，返回 5 条数据，耗时 123ms

测试 2: number=10, page=1
✅ 成功，返回 10 条数据，耗时 234ms

测试 3: number=20, page=1
✅ 成功，返回 20 条数据，耗时 456ms

结论: 所有测试通过，API 工作正常
```

### 场景 2: 测试分页功能

**你说：**
```
测试 Gank API 的前 5 页，每页 10 条，看看是否都能正常返回
```

**AI 回复：**
```
正在测试分页...

第 1 页: ✅ 成功，10 条数据
第 2 页: ✅ 成功，10 条数据
第 3 页: ✅ 成功，10 条数据
第 4 页: ✅ 成功，10 条数据
第 5 页: ✅ 成功，10 条数据

总计: 50 条数据
平均响应时间: 234ms
```

### 场景 3: 对比不同 API

**你说：**
```
对比 Gank API 和豆瓣 API 的响应时间
```

**AI 回复：**
```
正在对比...

Gank API:
- 响应时间: 234ms
- 状态: ✅ 正常
- 数据量: 10 条

豆瓣 API:
- 响应时间: 567ms
- 状态: ❌ 404 错误
- 错误信息: 页面不存在

结论: Gank API 更快且稳定
```

### 场景 4: 验证 API 是否失效

**你说：**
```
检查所有 API 是否还能正常使用
```

**AI 回复：**
```
正在检查...

✅ Gank API - 正常 (200 OK)
❌ 豆瓣 API - 失效 (404 Not Found)
⚠️  优美图库 API - 超时 (Timeout)

建议:
1. 豆瓣 API 已失效，需要更新 URL
2. 优美图库 API 响应慢，考虑增加超时时间
```

### 场景 5: 生成测试报告

**你说：**
```
生成所有 API 的详细测试报告
```

**AI 回复：**
```
API 测试报告
生成时间: 2026-01-15 10:30:00

总览:
- 总接口数: 3
- 正常: 1
- 失效: 1
- 超时: 1
- 成功率: 33.3%

详细信息:

1. Gank API
   - URL: http://gank.io/api/data/福利/10/1
   - 状态: ✅ 正常
   - 响应时间: 234ms
   - 数据量: 10 条

2. 豆瓣 API
   - URL: http://www.buxiuse.com/?cid=27&page=1
   - 状态: ❌ 失效
   - 错误: 404 Not Found
   - 建议: 更新 API URL

3. 优美图库 API
   - URL: http://www.umei.cc/bizhitupian/meinvbizhi/
   - 状态: ⚠️  超时
   - 响应时间: >30s
   - 建议: 增加超时时间或更换 API

建议行动:
1. 立即修复豆瓣 API
2. 优化优美图库 API 的超时处理
3. 考虑添加 API 健康检查
```

## 🎨 创意用法

### 用法 1: 自动化回归测试

**你说：**
```
每次我修改代码后，自动测试所有 API 是否还能正常工作
```

**AI 回复：**
```
好的，我会在你修改代码后自动运行 API 测试。

当前测试结果:
✅ 所有 API 正常工作
```

### 用法 2: 性能监控

**你说：**
```
监控 Gank API 的响应时间，如果超过 500ms 就提醒我
```

**AI 回复：**
```
已设置监控。

当前响应时间: 234ms ✅
阈值: 500ms
状态: 正常
```

### 用法 3: 数据验证

**你说：**
```
验证 Gank API 返回的数据结构是否符合预期
```

**AI 回复：**
```
正在验证数据结构...

预期结构:
{
  "error": boolean,
  "results": array
}

实际结构:
✅ error 字段存在且为 boolean
✅ results 字段存在且为 array
✅ results 中每个元素包含 _id, url, desc

结论: 数据结构完全符合预期
```

### 用法 4: 自动生成代码

**你说：**
```
根据 Gank API 的响应，生成 Kotlin 数据类
```

**AI 回复：**
```
已生成 Kotlin 数据类:

data class GankMeiziResult(
    val error: Boolean,
    val results: List<GankMeiziBody>
)

data class GankMeiziBody(
    @SerializedName("_id")
    val id: String,
    val url: String,
    val desc: String,
    val type: String,
    val who: String,
    val publishedAt: String
)

是否需要保存到文件？
```

## 💬 对话示例

### 示例 1: 调试失效的 API

**你:** 豆瓣 API 好像不能用了，帮我看看

**AI:** 让我测试一下...
调用 http://www.buxiuse.com/?cid=27&page=1
❌ 返回 404 错误

看起来这个 API 已经失效了。我可以帮你：
1. 搜索替代的豆瓣图片 API
2. 更新代码使用新的 API
3. 添加错误处理

你想怎么做？

**你:** 帮我搜索替代 API

**AI:** 好的，我找到了几个替代方案...

### 示例 2: 优化 API 调用

**你:** Gank API 有时候很慢，怎么优化？

**AI:** 让我分析一下...
测试了 10 次调用，平均响应时间 456ms

建议优化方案：
1. 添加缓存机制
2. 减少每次请求的数据量
3. 使用分页加载

我可以帮你实现这些优化，需要吗？

**你:** 帮我添加缓存

**AI:** 好的，我会修改代码添加 Room 缓存...

## 🎯 最佳实践

### 1. 定期健康检查

```
每天早上 9 点，自动检查所有 API 的健康状态
```

### 2. 版本对比

```
对比新旧版本 API 的响应差异
```

### 3. 文档同步

```
根据 API 实际响应，更新 Apifox 文档
```

### 4. 自动化测试

```
在 CI/CD 流程中集成 API 测试
```

## 📝 提示

1. **清晰描述**: 说明你想测试什么，AI 会自动选择合适的接口
2. **批量操作**: 可以一次测试多个接口或参数
3. **保存结果**: 可以要求 AI 保存测试结果到文件
4. **生成代码**: 可以根据 API 响应生成数据模型

## 🔗 相关文档

- [Apifox MCP 配置指南](../APIFOX-MCP-SETUP.md)
- [API 测试工具](API-TOOLS-SUMMARY.md)

---

**开始使用：在聊天窗口中输入 "列出我的 Apifox 项目"** 🚀
